(function(h,i,k,d){var g=30;var j=90;var f=40;var e=10;var o=h.rad2deg=function(p){return p/(Math.PI/180)};var m=h.deg2rad=function(p){return p*(Math.PI/180)};var c=navigator.platform.toLowerCase();var n=navigator.userAgent.toLowerCase();var a=(n.indexOf("iphone")>-1||n.indexOf("ipad")>-1||n.indexOf("ipod")>-1)&&(c.indexOf("iphone")>-1||c.indexOf("ipad")>-1||c.indexOf("ipod")>-1);var l=h.Picker=function(r,q){var p=this;p.holder=r;p.options=q||{};p.init();p.initInertiaParams();p.calcElementItemPostion(true);p.bindEvent()};l.prototype.findElementItems=function(){var p=this;p.elementItems=[].slice.call(p.holder.querySelectorAll("li"));return p.elementItems};l.prototype.init=function(){var p=this;p.list=p.holder.querySelector("ul");p.findElementItems();p.height=p.holder.offsetHeight;p.r=p.height/2-e;p.d=p.r*2;p.itemHeight=p.elementItems.length>0?p.elementItems[0].offsetHeight:f;p.itemAngle=parseInt(p.calcAngle(p.itemHeight*0.8));p.hightlightRange=p.itemAngle/2;p.visibleRange=j;p.beginAngle=0;p.beginExceed=p.beginAngle-g;p.list.angle=p.beginAngle;if(a){p.list.style.webkitTransformOrigin="center center "+p.r+"px"}};l.prototype.calcElementItemPostion=function(q){var p=this;if(q){p.items=[]}p.elementItems.forEach(function(t){var s=p.elementItems.indexOf(t);p.endAngle=p.itemAngle*s;t.angle=p.endAngle;t.style.webkitTransformOrigin="center center -"+p.r+"px";t.style.webkitTransform="translateZ("+p.r+"px) rotateX("+(-p.endAngle)+"deg)";if(q){var r={};r.text=t.innerHTML||"";r.value=t.getAttribute("data-value")||r.text;p.items.push(r)}});p.endExceed=p.endAngle+g;p.calcElementItemVisibility(p.beginAngle)};l.prototype.calcAngle=function(u){var s=this;var p=b=parseFloat(s.r);u=Math.abs(u);var r=parseInt(u/s.d)*180;u=u%s.d;var t=(p*p+b*b-u*u)/(2*p*b);var q=r+o(Math.acos(t));return q};l.prototype.calcElementItemVisibility=function(q){var p=this;p.elementItems.forEach(function(r){var s=Math.abs(r.angle-q);if(s<p.hightlightRange){r.classList.add("highlight")}else{if(s<p.visibleRange){r.classList.add("visible");r.classList.remove("highlight")}else{r.classList.remove("highlight");r.classList.remove("visible")}}})};l.prototype.setAngle=function(q){var p=this;p.list.angle=q;p.list.style.webkitTransform="perspective(1000px) rotateY(0deg) rotateX("+q+"deg)";p.calcElementItemVisibility(q)};l.prototype.bindEvent=function(){var q=this;var r=0;var p=null;q.holder.addEventListener("touchstart",function(s){s.preventDefault();q.list.style.webkitTransition="";p=(s.changedTouches?s.changedTouches[0]:s).pageY;r=q.list.angle;q.updateInertiaParams(s,true)},false);q.holder.addEventListener("touchend",function(s){s.preventDefault();q.startInertiaScroll(s)},false);q.holder.addEventListener("touchcancel",function(s){s.preventDefault();q.startInertiaScroll(s)},false);q.holder.addEventListener("touchmove",function(u){u.preventDefault();var t=(u.changedTouches?u.changedTouches[0]:u).pageY;var s=t-p;var w=q.calcAngle(s);var v=s>0?r-w:r+w;if(v>q.endExceed){v=q.endExceed}if(v<q.beginExceed){v=q.beginExceed}q.setAngle(v);q.updateInertiaParams(u)},false);q.list.addEventListener("tap",function(s){elementItem=s.target;if(elementItem.tagName=="LI"){q.setSelectedIndex(q.elementItems.indexOf(elementItem),200)}},false)};l.prototype.initInertiaParams=function(){var p=this;p.lastMoveTime=0;p.lastMoveStart=0;p.stopInertiaMove=false};l.prototype.updateInertiaParams=function(s,q){var r=this;var p=s.changedTouches?s.changedTouches[0]:s;if(q){r.lastMoveStart=p.pageY;r.lastMoveTime=s.timeStamp||Date.now();r.startAngle=r.list.angle}else{var t=s.timeStamp||Date.now();if(t-r.lastMoveTime>300){r.lastMoveTime=t;r.lastMoveStart=p.pageY}}r.stopInertiaMove=true};l.prototype.startInertiaScroll=function(p){var B=this;var y=p.changedTouches?p.changedTouches[0]:p;var z=p.timeStamp||Date.now();var A=(y.pageY-B.lastMoveStart)/(z-B.lastMoveTime);var r=A>0?-1:1;var w=r*0.0006*-1;var s=Math.abs(A/w);var x=A*s/2;var u=B.list.angle;var t=B.calcAngle(x)*r;var q=t;if(u+t<B.beginExceed){t=B.beginExceed-u;s=s*(t/q)*0.6}if(u+t>B.endExceed){t=B.endExceed-u;s=s*(t/q)*0.6}if(t==0){B.endScroll();return}B.scrollDistAngle(z,u,t,s)};l.prototype.scrollDistAngle=function(r,q,t,s){var p=this;p.stopInertiaMove=false;(function(x,u,A,y){var v=13;var B=y/v;var w=0;(function z(){if(p.stopInertiaMove){return}var C=p.quartEaseOut(w,u,A,B);p.setAngle(C);w++;if(w>B-1||C<p.beginExceed||C>p.endExceed){p.endScroll();return}setTimeout(z,v)})()})(r,q,t,s)};l.prototype.quartEaseOut=function(q,p,s,r){return -s*((q=q/r-1)*q*q*q-1)+p};l.prototype.endScroll=function(){var p=this;if(p.list.angle<p.beginAngle){p.list.style.webkitTransition="150ms ease-out";p.setAngle(p.beginAngle)}else{if(p.list.angle>p.endAngle){p.list.style.webkitTransition="150ms ease-out";p.setAngle(p.endAngle)}else{var q=parseInt((p.list.angle/p.itemAngle).toFixed(0));p.list.style.webkitTransition="100ms ease-out";p.setAngle(p.itemAngle*q)}}p.triggerChange()};l.prototype.triggerChange=function(q){var p=this;setTimeout(function(){var r=p.getSelectedIndex();var s=p.items[r];if(h.trigger&&(r!=p.lastIndex||q)){h.trigger(p.holder,"change",{index:r,item:s})}p.lastIndex=r},0)};l.prototype.correctAngle=function(q){var p=this;if(q<p.beginAngle){return p.beginAngle}else{if(q>p.endAngle){return p.endAngle}else{return q}}};l.prototype.setItems=function(r){var q=this;q.items=r||[];var p=[];q.items.forEach(function(s){if(s!==null&&s!==d){p.push("<li>"+(s.text||s)+"</li>")}});q.list.innerHTML=p.join("");q.findElementItems();q.calcElementItemPostion();q.setAngle(q.correctAngle(q.list.angle));q.triggerChange(true)};l.prototype.getItems=function(){var p=this;return p.items};l.prototype.getSelectedIndex=function(){var p=this;return parseInt((p.list.angle/p.itemAngle).toFixed(0))};l.prototype.setSelectedIndex=function(q,r){var p=this;p.list.style.webkitTransition="";var t=p.correctAngle(p.itemAngle*q);if(r&&r>0){var s=t-p.list.angle;p.scrollDistAngle(Date.now(),p.list.angle,s,r)}else{p.setAngle(t)}p.triggerChange()};l.prototype.getSelectedItem=function(){var p=this;return p.items[p.getSelectedIndex()]};l.prototype.getSelectedValue=function(){var p=this;return(p.items[p.getSelectedIndex()]||{}).value};l.prototype.getSelectedText=function(){var p=this;return(p.items[p.getSelectedIndex()]||{}).text};l.prototype.setSelectedValue=function(s,t){var p=this;for(var q in p.items){var r=p.items[q];if(r.value==s){p.setSelectedIndex(q,t);return}}};if(h.fn){h.fn.picker=function(p){this.each(function(t,s){if(s.picker){return}if(p){s.picker=new l(s,p)}else{var r=s.getAttribute("data-picker-options");var q=r?JSON.parse(r):{};s.picker=new l(s,q)}});return this[0]?this[0].picker:null};h.ready(function(){h(".mui-picker").picker()})}})(window.mui||window,window,document,undefined);(function(f,a){f.dom=function(g){if(typeof(g)!=="string"){if((g instanceof Array)||(g[0]&&g.length)){return[].slice.call(g)}else{return[g]}}if(!f.__create_dom_div__){f.__create_dom_div__=a.createElement("div")}f.__create_dom_div__.innerHTML=g;return[].slice.call(f.__create_dom_div__.childNodes)};var e='<div class="mui-poppicker">		<div class="mui-poppicker-header">			<button class="mui-btn mui-poppicker-btn-cancel">取消</button>			<button class="mui-btn mui-btn-blue mui-poppicker-btn-ok">确定</button>			<div class="mui-poppicker-clear"></div>		</div>		<div class="mui-poppicker-body">		</div>	</div>';var c='<div class="mui-picker">		<div class="mui-picker-inner">			<div class="mui-pciker-rule mui-pciker-rule-ft"></div>			<ul class="mui-pciker-list">			</ul>			<div class="mui-pciker-rule mui-pciker-rule-bg"></div>		</div>	</div>';var d=f.PopPicker=f.Class.extend({init:function(h){var g=this;g.options=h||{};g.options.buttons=g.options.buttons||["取消","确定"];g.panel=f.dom(e)[0];a.body.appendChild(g.panel);g.ok=g.panel.querySelector(".mui-poppicker-btn-ok");g.cancel=g.panel.querySelector(".mui-poppicker-btn-cancel");g.body=g.panel.querySelector(".mui-poppicker-body");g.mask=f.createMask();g.cancel.innerText=g.options.buttons[0];g.ok.innerText=g.options.buttons[1];g.cancel.addEventListener("tap",function(i){g.hide()},false);g.ok.addEventListener("tap",function(j){if(g.callback){var i=g.callback(g.getSelectedItems());if(i!==false){g.hide()}}},false);g.mask[0].addEventListener("tap",function(){g.hide()},false);g._createPicker();g.panel.addEventListener("touchstart",function(i){i.preventDefault()},false);g.panel.addEventListener("touchmove",function(i){i.preventDefault()},false)},_createPicker:function(){var g=this;var k=g.options.layer||1;var l=(100/k)+"%";g.pickers=[];for(var j=1;j<=k;j++){var m=f.dom(c)[0];m.style.width=l;g.body.appendChild(m);var h=f(m).picker();g.pickers.push(h);m.addEventListener("change",function(n){var p=this.nextSibling;if(p&&p.picker){var i=n.detail||{};var o=i.item||{};p.picker.setItems(o.children)}},false)}},setData:function(h){var g=this;h=h||[];g.pickers[0].setItems(h)},getSelectedItems:function(){var h=this;var g=[];for(var k in h.pickers){var j=h.pickers[k];g.push(j.getSelectedItem()||{})}return g},show:function(h){var g=this;g.callback=h;g.mask.show();a.body.classList.add(f.className("poppicker-active-for-page"));g.panel.classList.add(f.className("active"));g.__back=f.back;f.back=function(){g.hide()}},hide:function(){var g=this;if(g.disposed){return}g.panel.classList.remove(f.className("active"));g.mask.close();a.body.classList.remove(f.className("poppicker-active-for-page"));f.back=g.__back},dispose:function(){var g=this;g.hide();setTimeout(function(){g.panel.parentNode.removeChild(g.panel);for(var h in g){g[h]=null;delete g[h]}g.disposed=true},300)}})})(mui,document);(function(d,a){d.dom=function(f){if(typeof(f)!=="string"){if((f instanceof Array)||(f[0]&&f.length)){return[].slice.call(f)}else{return[f]}}if(!d.__create_dom_div__){d.__create_dom_div__=a.createElement("div")}d.__create_dom_div__.innerHTML=f;return[].slice.call(d.__create_dom_div__.childNodes)};var e='<div class="mui-dtpicker" data-type="datetime">		<div class="mui-dtpicker-header">			<button data-id="btn-cancel" class="mui-btn">取消</button>			<button data-id="btn-ok" class="mui-btn mui-btn-blue">确定</button>		</div>		<div class="mui-dtpicker-title"><h5 data-id="title-y">年</h5><h5 data-id="title-m">月</h5><h5 data-id="title-d">日</h5><h5 data-id="title-h">时</h5><h5 data-id="title-i">分</h5></div>		<div class="mui-dtpicker-body">			<div data-id="picker-y" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-m" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-d" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-h" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>			<div data-id="picker-i" class="mui-picker">				<div class="mui-picker-inner">					<div class="mui-pciker-rule mui-pciker-rule-ft"></div>					<ul class="mui-pciker-list">					</ul>					<div class="mui-pciker-rule mui-pciker-rule-bg"></div>				</div>			</div>		</div>	</div>';var c=d.DtPicker=d.Class.extend({init:function(g){var f=this;var i=d.dom(e)[0];a.body.appendChild(i);d('[data-id*="picker"]',i).picker();var h=f.ui={picker:i,mask:d.createMask(),ok:d('[data-id="btn-ok"]',i)[0],cancel:d('[data-id="btn-cancel"]',i)[0],y:d('[data-id="picker-y"]',i)[0],m:d('[data-id="picker-m"]',i)[0],d:d('[data-id="picker-d"]',i)[0],h:d('[data-id="picker-h"]',i)[0],i:d('[data-id="picker-i"]',i)[0],labels:d('[data-id*="title-"]',i),};h.cancel.addEventListener("tap",function(){f.hide()},false);h.ok.addEventListener("tap",function(){var j=f.callback(f.getSelected());if(j!==false){f.hide()}},false);h.y.addEventListener("change",function(){f._createDay()},false);h.m.addEventListener("change",function(){f._createDay()},false);h.mask[0].addEventListener("tap",function(){f.hide()},false);f._create(g);f.ui.picker.addEventListener("touchstart",function(j){j.preventDefault()},false);f.ui.picker.addEventListener("touchmove",function(j){j.preventDefault()},false)},getSelected:function(){var f=this;var i=f.ui;var h=f.options.type;var g={type:h,y:i.y.picker.getSelectedItem(),m:i.m.picker.getSelectedItem(),d:i.d.picker.getSelectedItem(),h:i.h.picker.getSelectedItem(),i:i.i.picker.getSelectedItem(),toString:function(){return this.value}};switch(h){case"datetime":g.value=g.y.value+"-"+g.m.value+"-"+g.d.value+" "+g.h.value+":"+g.i.value;g.text=g.y.text+"-"+g.m.text+"-"+g.d.text+" "+g.h.text+":"+g.i.text;break;case"date":g.value=g.y.value+"-"+g.m.value+"-"+g.d.value;g.text=g.y.text+"-"+g.m.text+"-"+g.d.text;break;case"time":g.value=g.h.value+":"+g.i.value;g.text=g.h.text+":"+g.i.text;break;case"month":g.value=g.y.value+"-"+g.m.value;g.text=g.y.text+"-"+g.m.text;break;case"hour":g.value=g.y.value+"-"+g.m.value+"-"+g.d.value+" "+g.h.value;g.text=g.y.text+"-"+g.m.text+"-"+g.d.text+" "+g.h.text;break}return g},setSelectedValue:function(i){var g=this;var h=g.ui;var f=g._parseValue(i);h.y.picker.setSelectedValue(f.y,0);h.m.picker.setSelectedValue(f.m,0);h.d.picker.setSelectedValue(f.d,0);h.h.picker.setSelectedValue(f.h,0);h.i.picker.setSelectedValue(f.i,0)},isLeapYear:function(f){return(f%4==0&&f%100!=0)||(f%400==0)},_inArray:function(i,h){for(var f in i){var g=i[f];if(g===h){return true}}return false},getDayNum:function(g,h){var f=this;if(f._inArray([1,3,5,7,8,10,12],h)){return 31}else{if(f._inArray([4,6,9,11],h)){return 30}else{if(f.isLeapYear(g)){return 29}else{return 28}}}},_fill:function(f){f=f.toString();if(f.length<2){f=0+f}return f},_createYear:function(i){var n=this;var o=n.options;var k=n.ui;var g=[];if(o.customData.y){g=o.customData.y}else{var h=new Date();var m=h.getFullYear();var f=1900;var l=h.getFullYear()+5;for(var j=f;j<=l;j++){g.push({text:j+"",value:j})}}k.y.picker.setItems(g)},_createMonth:function(k){var g=this;var h=g.options;var i=g.ui;var j=[];if(h.customData.m){j=h.customData.m}else{for(var f=1;f<=12;f++){var l=g._fill(f);j.push({text:l,value:l})}}i.m.picker.setItems(j)},_createDay:function(k){var f=this;var h=f.options;var j=f.ui;var i=[];if(h.customData.d){i=h.customData.d}else{var g=f.getDayNum(parseInt(j.y.picker.getSelectedValue()),parseInt(j.m.picker.getSelectedValue()));for(var m=1;m<=g;m++){var l=f._fill(m);i.push({text:l,value:l})}}j.d.picker.setItems(i);k=k||j.d.picker.getSelectedValue()},_createHours:function(l){var g=this;var i=g.options;var k=g.ui;var f=[];if(i.customData.h){f=i.customData.h}else{for(var j=0;j<=23;j++){var m=g._fill(j);f.push({text:m,value:m})}}k.h.picker.setItems(f)},_createMinutes:function(l){var g=this;var h=g.options;var k=g.ui;var f=[];if(h.customData.i){f=h.customData.i}else{for(var j=0;j<=59;j++){var m=g._fill(j);f.push({text:m,value:m})}}k.i.picker.setItems(f)},_setLabels:function(){var f=this;var g=f.options;var h=f.ui;h.labels.each(function(k,j){j.innerText=g.labels[k]})},_setButtons:function(){var f=this;var g=f.options;var h=f.ui;h.cancel.innerText=g.buttons[0];h.ok.innerText=g.buttons[1]},_parseValue:function(i){var g=this;var f={};if(i){var j=i.replace(":","-").replace(" ","-").split("-");f.y=j[0];f.m=j[1];f.d=j[2];f.h=j[3];f.i=j[4]}else{var h=new Date();f.y=h.getFullYear();f.m=h.getMonth()+1;f.d=h.getDate();f.h=h.getHours();f.i=h.getMinutes()}return f},_create:function(h){var f=this;h=h||{};h.labels=h.labels||["年","月","日","时","分"];h.buttons=h.buttons||["取消","确定"];h.type=h.type||"datetime";h.customData=h.customData||{};f.options=h;var g=new Date();h.beginYear=h.beginYear||(g.getFullYear()-5);h.endYear=h.endYear||(g.getFullYear()+5);var i=f.ui;f._setLabels();f._setButtons();i.picker.setAttribute("data-type",h.type);f._createYear();f._createMonth();f._createDay();f._createHours();f._createMinutes();f.setSelectedValue(h.value)},show:function(h){var f=this;var g=f.ui;f.callback=h||d.noop;g.mask.show();a.body.classList.add(d.className("dtpicker-active-for-page"));g.picker.classList.add(d.className("active"));f.__back=d.back;d.back=function(){f.hide()}},hide:function(){var f=this;if(f.disposed){return}var g=f.ui;g.picker.classList.remove(d.className("active"));g.mask.close();a.body.classList.remove(d.className("dtpicker-active-for-page"));d.back=f.__back},dispose:function(){var f=this;f.hide();setTimeout(function(){f.ui.picker.parentNode.removeChild(f.ui.picker);for(var g in f){f[g]=null;delete f[g]}f.disposed=true},300)}})})(mui,document);